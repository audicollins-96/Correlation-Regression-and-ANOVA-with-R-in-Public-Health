---
title: "Descriptive Statistics"
author: "Collins Audi"
date: "2025-09-26"
output:
  html_document: default
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Data Importation
whitehall <- read.csv("C:/Users/audic/Desktop/Fossa/module1/Whitehall_fossa.csv", header = TRUE, sep =',')
head(whitehall)
```
**Correlation and Scatter Plot in R**
Running the scatter plot to check the relationship or correlation between BMI and systolic blood pressure. The scatterplot of BMI versus systolic blood pressure shows a very slight upward trend. This visual impression is confirmed by the Pearson correlation coefficient (r = 0.085), indicating a very weak positive relationship. The association is statistically significant (p < 0.001), but the narrow confidence interval (0.056 to 0.115) shows that BMI suggests only a small proportion of the variability in systolic blood pressure in this simulated Whitehall cohort.
```{r}
plot(whitehall$bmi, whitehall$sbp, xlab = "BMI (Kg/m2)", ylab = "Systolic Blood Pressure", cex = 0.8)

cor.test(whitehall$bmi, whitehall$sbp, use=complete.obs)
```
**Running One-Way ANOVA in R**
The findings show that SBP varies among the four BMI categories, with a highly significant p-value of 0.0001. Nonetheless, ANOVA is an overall test and does not specify which specific BMI groups differ significantly from one another.
```{r}
factored_white <- factor(whitehall$bmi_grp4)

fit <- aov(whitehall$sbp~factored_white, data=whitehall)
summary(fit)
```
**Running a Linear Regression Model with Continuous Independent Variable**
The analysis shows a statistically significant positive association between Body Mass Index (BMI) and systolic blood pressure (SBP) in the Whitehall study data. The estimated regression coefficient for BMI is 0.45902 (p-value = 1.99e-08), meaning that for every one-unit increase in BMI, SBP is estimated to increase by 0.46 mmHg, on average. However, the model has very low predictive power, with an Adjusted R-squared of 0.007072 (less than 1%), indicating that BMI alone explains a negligible proportion of the variability in SBP.

```{r}
regfit1 <- lm(whitehall$sbp~whitehall$bmi, data = whitehall)
summary(regfit1)
```
**Running a Linear Regression Model with Categorical Independent Variable**
From the output above, the mean SBP rises with increasing BMI categories. Specifically, individuals in BMI group 4 (obese) have an average SBP that is 3.7 mmHg higher than those in BMI group 2 (normal weight) (95% CI: 1.7–5.6, p<0.001).
```{r}
#Creating a new empty BMI Column
whitehall$bmi.grouped <- NA

whitehall$bmi_fact<-factor(whitehall$bmi_grp4)
is.factor(whitehall$bmi_fact)
table(whitehall$bmi_fact)

aggregate(
  whitehall$sbp,              # x = systolic blood pressure values
  list(whitehall$bmi_fact),   # group by BMI category factor
  FUN = mean,                  # calculate mean in each group
  na.rm = TRUE)               # remove NAs when computing mean


#Model Fit
fit2 <- lm(sbp ~ bmi_fact, data=whitehall)
summary(fit2)

#Confidence Interval of Parameters
confint(fit2, level=0.95)

#Creating a copy of the dataset for running the second regression model with releveling of bmi dummy by setting reference category

whitehall2 <- whitehall

#By default R will use the lowest category of bmi_fact as the reference in a regression. But this category is the smallest and hence it is not a good reference category as all comparisons with it will have large confidence intervals. We can change the reference category using the ‘relevel’ function:

whitehall2<-within(whitehall2, bmi_fact<-relevel(bmi_fact,ref=2))

#Then we fit the same linear regression again:
fit3 <- lm(sbp ~ bmi_fact, data=whitehall2)
summary(fit3)
confint(fit3, level=0.95)
```
**Running a Multiple Linear Regression Model**
I ran a multiple linear regression model to examine the impact the association of BMI group on SBP, adjusted for LDL-C. As shown in the output, being overweight (BMI group 3), compared with normal weight (group 2), is associated with an average SBP that is 1.91 mmHg higher after adjusting for LDL-C (95% CI: 0.80–3.02, p=0.001). This association is slightly stronger for the overweight BMI group than it was before adjusting for LDL-C.

```{r}
multiple_fit <- lm(sbp ~ bmi_fact+ldlc, data=whitehall2)
summary(multiple_fit)
confint(multiple_fit, level=0.95)
```
**Adjusting for smoking status in the Multiple Regression model**
On average, being obese is associated with an SBP that is 3.7 mmHg higher than being normal weight after adjusting for LDL-C and current smoking (95% CI: 1.74–5.63, p<0.001). This association remained unchanged when additionally adjusting for current smoking.

Each covariate in the model can be interpreted as adjusted for the other covariates. For example, being a current smoker is associated with an SBP that is 0.56 mmHg lower compared to non-smokers, after adjusting for LDL-C and BMI group. However, the 95% CI includes the null value (0 in this case, since we are not using ratios; -2.15–1.02), indicating that this association is not statistically significant.


```{r}
multiple_fit2 <- lm(sbp ~ bmi_fact+ldlc+currsmoker, data=whitehall2)
summary(multiple_fit2)
```

**Model Selection and F Test**
**1. Testing if BMI contributes to model variation**
The results indicate that the F-statistic for testing the joint hypothesis that all BMI-related coefficients are zero is approximately 7.7, with a p-value below 0.001. Although the regression output suggests that not every BMI category is individually associated with SBP, the F-test demonstrates that, collectively, the BMI variable contributes significantly to explaining variation in the model (F[3, 4265] = 7.74, p < 0.001).

```{r}
library(car)

linearHypothesis(multiple_fit2, c("bmi_fact1=0", "bmi_fact3=0", "bmi_fact4=0"))

```

**1. Testing if LDLC and smoking contributes to model variation**
We can see from the output that the null hypothesis is that both variables have a coefficient equal to 0. However, there is evidence to reject this null hypothesis (F[2,4265]=4.92, p<0.01). These variables are significantly contributing to model fit.

```{r}
library(car)

linearHypothesis(multiple_fit2, c("ldlc=0", "currsmoker=0"))

```

**Checking for Normality of Residuals using Both Q-Q Plot and Histogram**
Since the plots show slight skew, we will check for potential influential variables or outliers in our data.
```{r}
qqnorm(resid(multiple_fit2), main = "Q–Q Plot of Residuals")
qqline(resid(multiple_fit2), col = "red")

hist(resid(multiple_fit2), main="Histogram of the residuals", xlab="Residuals")
```
**Check for outliers / influential points**

The chart confirms no significant influential variables.
```{r}
plot(influence.measures(multiple_fit2)$infmat[, "cook.d"])
```

**Fitted vs Residuals**
There appears to be a random ball of dots, with no pattern. This is what we want. There does not appear to be heteroscedasticity.
```{r}
plot(resid(multiple_fit2) ~ fitted(multiple_fit2), main="The residuals versus the fitted values", xlab="Fitted values", ylab="Residuals", cex=0.8)
abline(0,0, col=2)
```




















